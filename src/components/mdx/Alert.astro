---
/**
 * Alert - GitHub-style alerts/admonitions
 * Used by remark-gfm-alerts plugin to render GitHub-style blockquotes
 * Usage (in markdown):
 * > [!NOTE]
 * > This is a note.
 */
interface Props {
  type?: "note" | "tip" | "important" | "warning" | "caution" | "default";
  title?: string;
}

const { type = "default", title } = Astro.props;

// Map types to styles, icons, and default titles
const configs = {
  default: {
    bg: "bg-muted/50",
    border: "border-border",
    iconColor: "text-muted-foreground",
    titleColor: "text-foreground",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>`,
    defaultTitle: "Note",
  },
  note: {
    bg: "bg-blue-500/5",
    border: "border-blue-500/30",
    iconColor: "text-blue-500",
    titleColor: "text-blue-500",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>`,
    defaultTitle: "Note",
  },
  tip: {
    bg: "bg-emerald-500/5",
    border: "border-emerald-500/30",
    iconColor: "text-emerald-500",
    titleColor: "text-emerald-500",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636-.707.707M21 12h-1M4 12H3m3.343-5.657-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>`,
    defaultTitle: "Tip",
  },
  important: {
    bg: "bg-violet-500/5",
    border: "border-violet-500/30",
    iconColor: "text-violet-500",
    titleColor: "text-violet-500",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8-4-4H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3l-4 4Z"/>`,
    defaultTitle: "Important",
  },
  warning: {
    bg: "bg-amber-500/5",
    border: "border-amber-500/30",
    iconColor: "text-amber-500",
    titleColor: "text-amber-500",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"/>`,
    defaultTitle: "Warning",
  },
  caution: {
    bg: "bg-red-500/5",
    border: "border-red-500/30",
    iconColor: "text-red-500",
    titleColor: "text-red-500",
    icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3.75m0 3.75h.007v.008H12v-.008ZM8.21 17.747A9 9 0 1 1 19.79 7.253a9.001 9.001 0 0 1-11.58 10.494Z"/>`,
    defaultTitle: "Caution",
  },
};

const config = configs[type] || configs.default;
const displayTitle = title || config.defaultTitle;
---

<div class={`alert not-prose ${config.bg} ${config.border}`} role="alert">
  <div class={`alert-icon ${config.iconColor}`}>
    <svg
      class="w-5 h-5"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <Fragment set:html={config.icon} />
    </svg>
  </div>
  <div class="alert-content">
    <div class={`alert-title ${config.titleColor}`}>{displayTitle}</div>
    <div class="alert-body">
      <slot />
    </div>
  </div>
</div>

<style>
  @reference "../../styles/global.css";
  .alert {
    @apply flex gap-3 p-4 my-4 rounded-lg border;
  }

  .alert-icon {
    @apply flex-shrink-0 mt-0.5;
  }

  .alert-content {
    @apply flex-1 min-w-0;
  }

  .alert-title {
    @apply font-semibold text-sm mb-1;
  }

  .alert-body {
    @apply text-sm text-muted-foreground leading-relaxed;
  }

  .alert-body :global(p) {
    @apply my-1;
  }

  .alert-body :global(p:first-child) {
    @apply mt-0;
  }

  .alert-body :global(p:last-child) {
    @apply mb-0;
  }

  .alert-body :global(code) {
    @apply px-1.5 py-0.5 rounded bg-muted text-foreground text-xs border border-border;
  }

  .alert-body :global(a) {
    @apply text-primary underline underline-offset-2;
  }
</style>
