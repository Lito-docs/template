---
/**
 * Callout - Enhanced alert/admonition component (Mintlify-style)
 * Usage:
 * <Callout type="note" title="Note">This is important info</Callout>
 * <Callout type="warning">Be careful!</Callout>
 */
import Icon from '../Icon.astro';

interface Props {
  type?: 'note' | 'tip' | 'info' | 'warning' | 'danger' | 'check';
  title?: string;
  icon?: string;
}

const { type = 'note', title, icon } = Astro.props;

// Theme-aware configs using CSS variables
const configs = {
  note: {
    bg: 'bg-info-light',
    border: 'border-info/30',
    icon: 'lucide:lightbulb',
    iconBg: 'bg-info/20',
    title: 'Note',
    text: 'text-info'
  },
  tip: {
    bg: 'bg-success-light',
    border: 'border-success/30',
    icon: 'lucide:sparkles',
    iconBg: 'bg-success/20',
    title: 'Tip',
    text: 'text-success'
  },
  info: {
    bg: 'bg-info-light',
    border: 'border-info/30',
    icon: 'lucide:info',
    iconBg: 'bg-info/20',
    title: 'Info',
    text: 'text-info'
  },
  warning: {
    bg: 'bg-warning-light',
    border: 'border-warning/30',
    icon: 'lucide:triangle-alert',
    iconBg: 'bg-warning/20',
    title: 'Warning',
    text: 'text-warning'
  },
  danger: {
    bg: 'bg-danger-light',
    border: 'border-danger/30',
    icon: 'lucide:octagon-alert',
    iconBg: 'bg-danger/20',
    title: 'Danger',
    text: 'text-danger'
  },
  check: {
    bg: 'bg-success-light',
    border: 'border-success/30',
    icon: 'lucide:circle-check',
    iconBg: 'bg-success/20',
    title: 'Success',
    text: 'text-success'
  }
};

const config = configs[type] || configs.note;
const displayTitle = title || config.title;
const displayIcon = icon || config.icon;

// Check if icon is an Iconify name (contains :) or an emoji
const isIconifyIcon = displayIcon?.includes(':');
---

<div class={`callout not-prose ${config.bg} ${config.border}`}>
  <div class={`callout-icon ${config.iconBg}`}>
    {isIconifyIcon ? <Icon name={displayIcon} size={20} /> : <span>{displayIcon}</span>}
  </div>
  <div class="callout-content">
    <div class={`callout-title ${config.text}`}>{displayTitle}</div>
    <div class="callout-body">
      <slot />
    </div>
  </div>
</div>

<style>
  @reference "../../styles/global.css";
  .callout {
    @apply flex gap-4 p-5 my-6 rounded-lg border;
    box-shadow: var(--shadow-sm);
    transition: all 150ms ease;
  }

  .callout:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  .callout-icon {
    @apply flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center text-lg;
    box-shadow: var(--shadow-xs);
  }

  .callout-content {
    @apply flex-1 min-w-0;
  }

  .callout-title {
    @apply font-semibold text-sm mb-1;
  }

  .callout-body {
    @apply text-sm text-muted-foreground leading-relaxed;
  }

  .callout-body :global(p) {
    @apply my-1;
  }

  .callout-body :global(p:last-child) {
    @apply mb-0;
  }

  .callout-body :global(code) {
    @apply px-1.5 py-0.5 rounded bg-muted text-foreground text-xs border border-border;
  }
</style>
